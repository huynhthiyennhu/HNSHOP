@model List<HNSHOP.Dtos.Response.NotificationDTO>
@{
    ViewData["Title"] = "Thông Báo Của Bạn";
}
<style>
    .notification-background {
        min-height: 300px;
        position: relative;
    }

        .notification-background::before {
            content: "";
            background-image: url('/images/home/thongbao.jpg');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            opacity: 0.1; 
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 1;
            pointer-events: none;
        }

</style>
<section id="cart_items">
    <div class="container p-5">
        <div class="breadcrumbs">
            <ol class="breadcrumb">
                <li><a asp-controller="Home" asp-action="Index">Home</a></li>
                <li class="active">Thông Báo</li>
            </ol>
        </div>
        <div class="row">
            <div class="col-12">
                <h2 class="title text-center mb-4 text-warning">
                    <i class="fa fa-bell"></i> THÔNG BÁO CỦA BẠN
                </h2>

                <div class="notification-background position-relative rounded overflow-hidden p-4">
                    <div class="position-relative" style="z-index: 2;">
                        @foreach (var item in Model)
                        {
                            <div class="list-group-item mb-3 shadow-sm bg-white rounded @(item.IsRead ? "" : "border-left border-info")">
                                <div class="d-flex justify-content-between align-items-center flex-wrap">
                                    <div class="mr-auto">
                                        <h4 class="mb-1" style="color:coral">@item.Title</h4>
                                        <h5 class="mb-1">@item.Body</h5>
                                    </div>
                                    <div class="text-right ml-3 d-flex flex-column align-items-end" style="min-width: 150px;">
                                        <small class="text-muted mb-2">@item.CreatedAt.ToString("HH:mm dd/MM/yyyy")</small>

                                        @if (!item.IsRead)
                                        {
                                            <button class="btn btn-sm btn-outline-primary mark-read-btn" data-id="@item.Id">
                                                <i class="fa fa-check-circle"></i> Đánh dấu đã đọc
                                            </button>
                                        }
                                        else
                                        {
                                            <span class="badge badge-pill badge-secondary" style="font-size: 0.85rem;">
                                                <i class="fa fa-check"></i> Đã đọc
                                            </span>
                                        }
                                    </div>
                                </div>
                            </div>
                        }
                    </div>
                </div>

            </div>
        </div>
        <br />
</div>
</section>
@section Scripts {
    <script>
        $(document).ready(function () {
            $('.mark-read-btn').click(function () {
                const btn = $(this);
                const id = btn.data('id');

                $.post('/Notification/MarkAsRead', { notificationId: id }, function () {
                    btn.replaceWith('<span class="badge badge-pill badge-secondary" style="font-size: 0.85rem;"><i class="fa fa-check"></i> Đã đọc</span>');
                    $('#notification-' + id).removeClass('bg-light border-left border-info');
                });
            });
        });
    </script>
}
